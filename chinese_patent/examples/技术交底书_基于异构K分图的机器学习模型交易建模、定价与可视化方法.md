# 技术交底书_基于异构K分图的机器学习模型交易建模、定价与可视化方法

## 1、详细介绍技术背景，并描述已有的与本发明相关的现有技术，说明现有技术的缺点
<!-- 撰写指导：
只写与本发明有关的技术背景以及现有技术、现有技术的缺点。
 -->

数据已经成为驱动人工智能产品和服务的重要资源，然而庞大训练数据集的交易对买方的数据接收和处理能力提出了严格的要求，从而提高了交易门槛。同时，原始数据的直接交易导致的隐私问题也阻碍了数据所有者直接与第三方分享数据。考虑到以数据为中心的下游产业，如模型训练、分析预测等方面的应用，专注于模型销售的模型市场将可以有效缓解数据交易的隐私隐患，并且买方可以直接部署购买的模型而无需额外的数据分析、传输开销。
虽然模型交易相较于传统数据交易具有诸多优势，但是现有的模型交易专利技术仍处于起步阶段，仅有的相关专利只对交易流程相关环节或具体应用进行设计，如CN114610271A，旨在协调模型的供需匹配；CN111915294A，利用区块链技术解决可交易的分布式机器学习中拜占庭攻击问题；CN105893522A，针对大数据分析模型业务的开发生成和管理系统；CN112396493A，以算法模型作为数据载体，设计了数据交易平台。
以上现有专利技术均未考虑在模型交易中信息不对称的情况下，模型买卖双方策略性的交易行为、相应的卖方模型最优定价方案以及大规模模型市场运作的即时性等问题。具体而言，在实际中，卖方往往比买方更了解模型的质量（训练数据集、验证数据集等的支撑），从而导致了模型交易中的信息不对称，卖方因此可能会提供有关模型质量的虚假信息以提高交易收益。而考虑到模型性能表现的概率特性（如模型性能在不同测试场景、测试集下的表现不同；测试样本的采样偏差对模型性能表现的影响），模型买方基于通常的评估验收步骤无法有效解决模型交易中的信息不对称问题，并且还会因此产生额外的验证开销，减少收益。更进一步的，买方收益降低将会影响其最大可承受模型价格，从而降低卖方收益，使得模型市场买卖双方的收益损失在不信任的验证对抗中。如果考虑具有非强制性模型验证的交易框架，模型买方将会策略性地采用模型验证以针对模型卖方潜在的欺骗性模型交易行为。相应地，模型卖方也会更加谨慎的考虑模型交付策略。但对于这种场景，模型市场就需要对买卖双方的交易行为和交易策略进行高效计算，否则面对大规模模型市场的庞大交易数据和计算工作量，难以实现交易的即时性，影响模型市场的正常运作。除此以外，平台还需要对历次交易信息进行有效管理，从而刻画市场中的用户属性，制定最优模型定价方案，实现手的最大化。

## 2、本发明摘要：针对现有技术存在的技术问题，提出本发明的基本方案或基本思路，以及本发明针对现有技术所具备的整体技术效果
<!-- 撰写指导：
不必描述实施细节，概括说明本发明的方案或思路，并说明由这种方案能带来的技术效果。
 -->
本发明公开了一种基于异构K分图的机器学习模型交易建模、定价与可视化方法，利用异构图神经网络的表示学习方法，如General Attributed Multiplex Heterogeneous Network Embedding(GATNE)等来关联可视化模型交易，首先为每个买方构建交易信息图模型如图二所示，由卖方的交易信息子节点（模型集合、价格集合、模型成本集合）通过无权重有向边（边类型为信息构建及查询路径）指向交易信息存储数组的父结点（节点类型为卖方交易属性），接着由买方的交易信息子节点（模型效用集合、模型验证成本、模型验证准确率）以及交易信息父节点通过无权重有向边（边类型为博弈构建及查询路径）指向买方节点（节点类型为模型交易博弈）。最终，每个买方构建完成由卖方交易信息集、卖方交易信息存储、买方交易信息集、买方交易信息存储的异构四分图K_3,1,3,1（heterogeneous four-partite graph），如图二的颜色标识所示。基于该交易信息图模型，利用图对抗神经网络求解该次模型交易博弈的双方策略纳什均衡，买方由此做出相应的交易决策。通过异构K分图的构建，买方可以可视化模型交易，简洁地对复杂交易信息进行建模和融合，从而高效地关联分析该次交易的关系数据，降低关联存储与节点的冗余度。相较于一般的模型交易流程和算法，该方法可以进一步应用如图查询、图计算等技术。其次，相类似的，卖方针对每次模型交易构建用户信息图模型，如图三所示，基于买方发出的订购决策，由买方相应的交易信息子节点（订购模型效用、模型验证成本、订购模型验证准确率）通过无权重有向边（边类型为信息构建及查询路径）指向用户信息存储数组的父节点（节点类型为买方交易属性），接着联合卖方的交易信息子节点（订购模型价格、模型集合、订购模型成本）通过无权重有向边（边属性为博弈构建及查询路径）指向卖方节点（节点类型为模型交易博弈）。最终卖方将构建完成由买方信息交易集（订购决策自适应筛检）、买方交易信息存储、卖方交易信息集（订购决策自适应筛检）、卖方交易存储的四分图K_3,1,3,1，如图三的颜色标识（图三中沿用图二的颜色标识的节点表示两者信息相同，即筛检不改变信息）所示。基于该用户信息图模型，卖方同样利用图对抗神经网络求解该次模型交易博弈的双方策略纳什均衡，并由此做出相应的交易策略。当交易完成时，卖方存储该次交易的用户信息图模型到用户信息矩阵，从而更新和分析模型交易市场中的用户各类特性分布，全局优化、迭代调整公布的模型价格，最大化收益。
本发明通过允许买卖双方构建和绘制异构图模型，将模型交易流程信息可视化，从而构建模型交易双方的交易策略博弈。利用图对抗神经网络求解机器学习模型交易中买卖双方的最优交易策略（纳什均衡策略），为买方在信息不对称的模型交易下合理使用模型验证提供了支撑（由于信息不对称，卖方在交付模型时可能选择低于买方订单要求的低质量模型，从而降低模型成本，提高收益。在这种情况下，买方可能会只订购最低质量的模型或拒绝模型交易以避免模型欺骗，使得模型交易的大规模部署和推广变得困难）。相较于不支持模型验证，或简单强制加入模型验收环节的模型交易框架，本发明通过基于异构K分图模型的策略均衡分析有效的降低了模型交易中买卖双方的信息不对称，提高了买卖双方的收益。更进一步地，通过发展具有成本效益（低模型验证成本，高模型验证判断准确率）的模型验证，本发明将会推动高效的模型交易市场发展，达到完全信息场景下的模型交易效果（买方的模型验证将成为威慑手段而不必实际使用，节约了验证成本）。除此以外，基于异构K分图的模型交易市场可视化建模将可以提高交易效率，支持以数据和重要相关数据集为中心的形式概念分析（formal concept analysis），融合模型交易的复杂信息，并且可以使用已知算法来进行相关计算，从而缩短交易流程所需时间，借助图查询、图计算等相关技术降低计算复杂度，满足大规模模型交易市场部署的即时性需求。卖方也因此可以通过历次交易构建的用户信息图模型，系统性的汇总和分析模型市场用户特性，迭代优化模型价格，从而最大化模型交易的收益，促进模型交易相关产业的发展，激励相关产业提供更优质的模型产品服务。

## 3、本发明技术方案的详细阐述，应该结合机械图、流程图、原理框图、电路图、时序图进行说明
<!-- 撰写指导：
3．1、充分说明本发明每一个详细技术方案，
3．2、本发明技术方案带来的效果的详细描述，不仅要说明本发明整体能带来的效果，而且由于某些技术特征可以直接导致的技术效果，也应该在这里结合技术特征的说明来描述效果；
3．3、充分说明所有可以实现本发明的实施方式，主要从实现本发明的细节角度考虑是否有相类似的方式方法或者其他变形的方法，如果有，则请列出。
 -->

本发明的主要目的是提供一种基于异构K分图模型的模型交易市场可视化建模，进而分析交易策略来定价、优化的模型交易方法。
其主要特点是在模型买方可以于交易完成前使用自己的测试集验证卖方交付模型的前提下，允许买卖双方绘制和构建交易信息、用户信息图模型，通过该类异构K分图模型系统可视化、汇总存储模型交易中的各类信息，融合复杂信息降低存储冗余度，并由此借助图查询和图对抗神经网络分析求解买卖双方交易策略的纳什均衡，提高模型市场交易效率，减少计算复杂度。利用策略性的交易行为可以有效威慑模型卖方潜在的模型欺骗决策，减少模型交易中买卖双方的信息不对称。更进一步的，模型卖方可以借助在每次模型交易中所绘制的用户信息图模型推测模型交易市场中各类用户的属性分布，从而迭代优化定价策略，提高收益。
为实现上述目的，该基于异构K分图的机器学习模型交易流程的技术方法如下，具体流程如图一所示）：
S1：各类数据所有者通过加密渠道贡献数据到模型卖方，如通过区块链技术等。
S2：模型卖方对数据所有者提供的数据进行分析、训练，获得一系列不同品质（性能）的模型。不失一般性的，模型卖方公布具有N个不同版本模型的集合M并按照模型质量排序：M_1,⋯〖,M〗_N，其中M_N为最高质量的售卖模型，M_1为最低质量的售卖模型。同时，公布相应的模型价格p={p_1,⋯〖,p〗*N}。
S3:模型买方根据所公布的模型集合M、价格集合p、预估的模型成本集合C={C_1,⋯〖,C〗*N}、各个模型对于买方的效用值集合U={U_1,⋯〖,U〗*N}、模型验证流程中的预估判断准确率δ*(m,n)(m为模型买方的订购模型下标，n为模型卖方实际交付模型下标)、模型验证的成本C_T等构建交易信息图模型，如图二所示。其中所述交易信息图模型为异构四分图K_3,1,3,1，包含卖方交易信息集、卖方交易信息存储、买方交易信息集、买方交易信息存储四个独立信息集合，首先由多个用于表示模型卖方交易信息的子节点（模型集合、价格集合、模型成本集合），通过无权重有向边（边类型为信息构建及查询路径）指向信息存储数组的父节点（交易信息，节点类型为卖方交易属性），最后联合买方模型效用集合、模型验证成本以及模型验证准确率信息等子节点，最终指向（边类型为博弈构建及查询路径）买方节点（节点类型为模型交易博弈），构建完成该异构K分图模型。每个节点拥有相关信息数据的存储矩阵，每条有向边代表信息传输的方向和计算顺序。模型买方通过交易信息图模型中的第一个父节点——交易信息节点将每个卖方所售模型的收益计算完毕，再通过图模型中的第二个父节点——买方节点汇总模型交易的所有基本信息，构建买卖双方定价、购买的顺序博弈以及交付、验证的同时博弈，借助图对抗神经网络利用反向推导总结各类交易策略纳什均衡下的买方模型交易期望收益，最终输出收益以及决策矩阵。根据所输出的收益-决策矩阵结果，买方选取最优收益所对应的决策向量(r*,v*),以此确定是否订购模型以及所订购的模型质量决策r∈{0,1,⋯,N\}，其中r表示买方所订购的模型下标，0表示不进行订购。v=V表示在订购模型的条件下，买方决定进行模型验证；v=NV表示买方决定不进行模型验证，直接接收模型并付款p_r。
S4：模型卖方获取买方的模型订单决策r以及相对应的效用值U_r、模型价格p_r、 模型验证流程中的预估判断准确率δ*(r,n), 模型验证的成本C_T，绘制用户信息图模型，如图三所示。与交易信息图模型相类似，用户信息图也为异构四分图K_3,1,3,1，包含买方交易信息集（订购决策自适应筛检）、买方交易信息存储、卖方交易信息集（订购决策自适应筛检）、卖方交易存储四个独立信息集（图三中沿用图二的颜色标识的节点表示两者信息相同，即筛检不改变信息）。每个子节点存储有相关信息数据，通过有向边进行信息传输和收益计算。首先根据S3中用户的模型质量决策r∈{1,⋯,N\} （r=0表示模型交易在S3终止），构建订购模型效用信息、模型验证成本信息、订购模型验证准确率信息子节点，由无权重有向边（边属性为信息构建及查询路径）指向用户信息存储数组的父节点（用户信息，节点类型为买方交易属性），联合订购模型价格、订购模型成本信息子节点及模型集合子节点，最终指向（边属性为博弈构建及查询路径）卖方节点（节点类型为模型交易博弈），绘制完成模型卖方的用户信息图模型。具体而言，模型卖方利用买方的订单决策r，在用户信息图的子结点中筛选出相对应的买方信息向量，通过第一个父节点——用户信息节点将买方期望收益计算完毕，再通过图模型中的第二个父节点——卖方节点汇总该次交易的所有基本信息，构建买卖双方交付、验证的同时博弈，借助图对抗神经网络基于反向推导总结该次交易各类策略纳什均衡下卖方模型交易期望收益，最终输出最优收益所对应的交付策略，即交付模型索引。最后，卖方通过用户信息图模型分析输出的索引值结果做出相应的交付决策，即交付买方订单中所订购的模型s∈{1,⋯,N\}。
S3-4:特别地，在S3、S4中基于异构K分图模型第二个父节点分析得到的纳什均衡策略将会在给定任意对方均衡策略的条件下，使得买卖双方的收益均最大。具体而言，在S3阶段，买卖双方的混合策略表示为σ_v∈∆V、σ_s∈∆S，其中∆V、∆S为有限集合\{NV,V}和\{1,⋯,N\}上的单纯形，即买卖双方验证与交付策略集的概率化表示： 。并由此分析得到交易策略均衡σ_v^*和σ_s^*，满足 。其中买卖双方交易收益及其组成部分详细表示如下： ； ； ； ； 。根据图对抗神经网络求解得到的验证、交付同时博弈中的均衡策略，买方由交易信息图模型反向推导可得使其收益最大化的最优订购策略r*。而在S4阶段，由于买方订购策略r已经披露，卖方仅需通过用户信息图模型求解得到验证与交付均衡策略，导出交付模型索引值，执行相应的交付决定。
S5：买方借助S3中图模型分析输出的收益-决策矩阵，筛选出最优收益决策向量(r*,v*)，从而决定是否进行模型验证。如果决定验证模型，则需收集测试数据集（支付测试成本C_T），并将数据测试集提交至第三方平台以对卖方交付模型进行性能测试，或直接使用卖方提供的API接口进行测试。根据测试结果，买方将自行决定是否接受交付模型，如接受，则付款，否则将拒绝交易（特别地，买方通过测试结果对于交付模型实际质量的判断准确率为δ*(r,s)）。如不进行模型验证，则无需任何测试成本，直接接收模型并付款p_r，具体流程如图四所示。
S6：当买方确定交易、接收模型并付款p_r后，模型卖方根据模型M_r训练中所使用的数据，进行贡献评估，即参与模型训练的数据对模型性能的贡献程度（如Shapley值，基于蒙特卡洛采样的Shapley评估方法等）。基于数据所有者所提供数据的贡献程度，进行隐私补偿和贡献奖励。
S7：交易完成后，模型卖方将该次交易生成的用户信息图存储为属性向量，通过库中所有的用户属性向量（即历次模型交易中构建的用户信息图模型）组成的存储矩阵刻画模型交易市场中的用户各类属性分布，动态优化、调整S2中的模型价格，整体流程如图五所示（通过模型市场中的不断交易，循坏迭代，收敛到最优模型价格，使模型卖方收益最大化）。

## 4、本发明创新的关键点和想保护的技术方案是什么？
<!-- 撰写指导：
与已知的现有技术相比，本发明会有一些与其不同的关键区别点，这些关键区别点通常会带来明显的或重要的技术效果，这里请说明哪些点是关键区别点，并将这些点可能的组合方案都列举出来。
 -->

本发明与现有方法相比具有如下优点：

第一，与现有的模型交易平台算法相比，本发明采用异构K分图的方式对机器学习模型交易进行可视化建模，将模型交易中的复杂信息进行融合，便于高效地图关联分析交易中的信息关系，降低关联存储与节点的冗余度，便于进一步应用如图查询、图计算等相关技术。
第二，与现有的模型交易定价方法相比， 本发明借助异构K分图的可视化建模，构建模型交易买卖双方的交易策略博弈，结合机器学习算法与图神经网络高效求解。在此基础上，通过对交易数据、单次交易生成的用户信息图的汇总，动态优化调整所售模型价格，收敛到模型市场的最优模型价格，实现模型卖方的收益优化，有利于推动产业发展，为模型市场提供更优质的模型服务，也为下游数据生成、供给产业的发展提供了可能。
第三，与没有模型模型验证或简单强制加入模型验证流程的交易框架相比，本发明允许买卖双方构建交易信息图模型及用户信息图模型，从而结合该异构K分图模型和图对抗神经网络求解交易策略纳什均衡。买方由此可以节省模型验证成本（模型验证仅作为威慑手段而不实际使用）。同时，交易策略均衡将会使得买方接受由于验证不完美性（由于模型性能验证表现的概率特性）带来的模型验证阶段性能波动，在一定程度上维护了卖方利益，为模型交易市场买卖双方的信任构建创造了良好环境，有利于整个市场的向上发展。
第四，与传统数据交易相比，本发明通过模型这种数据衍生物，避免了买方对原始数据的直接接触，有效的缓解了数据交易带来的隐私泄露等问题。

## 5、本发明可能的变更设计方向或者变形方案？
<!-- 撰写指导：
从整体考虑，是否有整体的替代或变形方案，或者对核心技术特征的替代或变形方案；主要根据本发明体现出来的设计思路，别人能不能想到其他的整体的替代方案来实现；
从另一个角度讲：考虑授权后，站在竞争对手的角度可能提出的回避设计方案。
 -->

 换用其他数据衍生物等无法直接观测交付产品质量，需要买方额外付出成本的数据产品及服务。
 换用其他验证方法或验证技术，但同样在一定程度上表明给出交付产品实际质量的相关信息。
 使用模型、数据交易混合共存的交易平台或市场。
 使用其他神经网络或博弈求解算法，但仍基于买卖双方策略性交易行为的分析及博弈构建。
 换用其他存储模式或算法，但仍通过历史交易信息循环优化模型价格。
 换用其他可视化模型或复杂信息建模方法，但仍保证模型交易市场中的高效关联分析与信息查询、计算的即时性

## 6、发明人补充的其他观点和思路
<!-- 撰写指导：
除1－5部分还需要补充的部分。
 -->
## 7、图及说明
<!-- 撰写指导：
1、交底书部分中未提及的附图标记不得在附图中出现，附图中未出现的附图标记不得在交底书文字中提及；
2、附图中除必须词语（如电路或程序的方框图、流程图、波形图等）外，尽量不要包含有其它文字注释；
3、同一部件或部分的附图标记在前后几幅附图中应一致，同一附图标记不得表示不同的部件或部分；
4、附图集中放在交底书文字之后；
5、附图中，零部件的编号可以用数字表示，也可以直接用零部件的名称来表示。
 -->
正文：
为了更清楚地说明本发明实施例及现有技术中的技术方案，下面将对所需要使用的附图作简单的介绍：

图一为模型交易框架示意图：

图二为交易信息图模型：

图三为用户信息图模型：

图四为模型交易流程：

图五为模型卖方定价方案优化流程：

图六为异构K分图模型构建以及图对抗神经网络求解流程
