# 技术交底书_一种基于联邦分析的分布式隐私数据挖掘方法

## 1、详细介绍技术背景，并描述已有的与本发明相关的现有技术，说明现有技术的缺点
<!-- 撰写指导：
只写与本发明有关的技术背景以及现有技术、现有技术的缺点。
 -->

频繁数据挖掘是目前大数据挖掘领域中的一个重要方向。传统的频繁数据挖掘要求参与方将本地数据传输给数据中心，并由数据中心统计出频繁数据，例如专利CN110286775A，不同用户通过输入法输入单词，并将信息传输到服务端，服务端将统计来自不同用户的信息分析出用户群体中的常用语。然而，这种传统的频繁数据挖掘方法需要实时传输用户的敏感信息，在数据隐私保护场景下难以实现。专利CN115510071A提出利用中心差分隐私技术给数据库响应结果加噪声再发送给请求方。然而，上述方法依赖于完全可信的数据中心，因为用户的原始敏感数据仍然保留在数据中心上，但在现实中，完全可信的数据中心是无法实现的。
联邦分析技术（Federated Analytics，FA）能够允许服务端在参与方原始数据不出本地的前提下分析多个参与方的数据信息，参与方需要对原始数据进行处理并发送给中心服务端。为了在半可信的执行环境下保护用户的数据隐私，本地差分隐私（Local differential Privacy, LDP）是一个可证明的本地隐私标准，用户可以通过本地差分隐私算法对本地数据进行处理，如扰动处理。在保护用户数据隐私下，服务端可以通过对来自用户的扰动数据进行统计分析来获取有价值的信息。现有的专利（如CN114153319A）采用了前缀树模型与本地差分隐私算法来分析用户群组的频繁词，但该方法没有考虑现实终端的有限计算资源，如客户端需要进行哈希运算，计算复杂度较高，特别是在计算能力非独立分布的分布式场景下，会导致算法执行的延时并影响用户体验与分析结果的实效性。另外，该算法所采用的构建前缀树的方式让参与者完全依赖于给定的前缀候选域，从而影响了算法的准确性。

## 2、本发明摘要：针对现有技术存在的技术问题，提出本发明的基本方案或基本思路，以及本发明针对现有技术所具备的整体技术效果
<!-- 撰写指导：
不必描述实施细节，概括说明本发明的方案或思路，并说明由这种方案能带来的技术效果。
 -->
本发明公开了基于联邦分析与差分隐私技术的频繁数据挖掘算法。首先，服务端将所有的参与方分组，每一组的客户端负责扩展前缀树的一个层次。其次，服务端按照顺序分别与多组客户端交互，每一次迭代中，服务端将前缀回应领域广播给一组客户端。再次，客户端参考接收到的回应领域，并利用本地差分隐私算法扰动本地的数据。然后，服务端聚合来自客户端的扰动数据，选择前k个频次高的前缀拓展前缀树。最后，当前缀树深度达到设定的最大深度时，服务端根据前缀树得出前k个频繁数据。
通过联邦分析算法，服务端与客户端交互信息来构建前缀树模型，并最后得到用户群体中的前k个被最频繁使用的数据，如单词等。在保证用户本地数据隐私的同时，算法中所提出的分组策略和本地差分隐私算法，不仅降低了客户端通讯的延时，还提升了预测结果的准确性。

## 3、本发明技术方案的详细阐述，应该结合机械图、流程图、原理框图、电路图、时序图进行说明
<!-- 撰写指导：
3．1、充分说明本发明每一个详细技术方案，
3．2、本发明技术方案带来的效果的详细描述，不仅要说明本发明整体能带来的效果，而且由于某些技术特征可以直接导致的技术效果，也应该在这里结合技术特征的说明来描述效果；
3．3、充分说明所有可以实现本发明的实施方式，主要从实现本发明的细节角度考虑是否有相类似的方式方法或者其他变形的方法，如果有，则请列出。
 -->

本发明的主要目的是设计一种面向分布式隐私频繁数据挖掘的联邦分析算法。其主要特点是客户端利用本地差分隐私算法扰动本地数据，仅将扰动后的数据发送给联邦服务端，减少了客户端的计算负载并降低了总体的计算等待时间。联邦服务端与不同用户群组交互并迭代，利用收集的扰动数据进行统计分析，并扩展前缀树模型，提高了算法效率与模型鲁棒性。为实现上述目的，本发明的具体技术步骤如下：
 将所用参与方（用户）分成不相干的多个群组：设所有参与用户数量总数为n，且前缀树的最大深度为g。服务端将所有用户划分为g个不相干的群组（不同群组用U_1,U_2,…,U_g表示），即一个用户最多只在一个群组中。群组U_i中用户的总数量为n_i=2\/2g+(i-1)n\/(g^2-g)，且群组中用户的数量满足线型递增，即n_i>n_j  (i>j)。该策略给后来的参与者赋予更多的 "重要性"，因为他们不仅验证了早期参与者发现的前缀，并提供了更多关于频繁数据的信息，即更长的前缀段。因此，随着迭代的进行，该策略通过增加客户端的数量，从而让更多的后来的参与者提高算法的准确性。
 初始化根结点，服务端与不同群组交互数据来自上而下的构建前缀树，且每一个群组负责扩展前缀树的一层，下层构建参与者需要等待前缀睡上层构建完成后再与服务端交互数据。
  2a.服务端：在第i次迭代中，服务端与群组U_i交互来扩展前缀树的第i层。
   （1）服务端将候选前缀域Φ_i广播给群组U_i的客户端。
   （2）服务端收集来自群组U_i中客户端的扰动前缀段v[:b_i ]，其中𝑣是客户端本地数据的二进制形式，b_i=i*L\/g是扩展前缀树第𝑖层所需的比特数。
   （3）服务端统计得到前k个频繁的前缀A_i，|A_i |≤k。然后,服务端为下一次迭代更新候选前缀域Φ_(i+1)=A_i。
  2b.用户端：每个组U_i中的客户端应用𝜀-LDP扰动算法，GRR_X，来扰乱他们本地数据的前缀段v[:b_i ]，其中𝑣是客户端本地数据的二进制形式，位长b_i=i*L\/g，产生一个被扰动的段𝑦 =M_(GRR_X ) （v[0:b_i ]），这个被扰乱的前缀段被发送给服务端。
   （1） M_(GRR_X )扰动机制首先需要客户端在给定一个候选域Φ_i下产生一个候选扩展域〖Φ_i〗^*=Φ_i  + X（候选域的大小d=|〖Φ_i〗^*  |）,其中，X的值取决于客户端并不向服务端公开,引入𝑋的是为了这为放松严格限制域，即不完全依赖早期参与者发现的前缀，在允许客户端发送域外数据的同时并保护域内与域外的数据隐私。构建候选扩展域〖Φ_i〗^*的步骤如下：
   （1.1）若客户端本地数据v[0:b_i ]不在候选域Φ_i中，客户端则向Φ_i中添加X= v[0:b_i ]构成〖Φ_i〗^*；
   （1.2）若本地数据不在Φ_i中，则客户端随机产生一个位长为b_i的前缀段，即X = randint(〖0,2〗^(b_i ) )来构成〖Φ_i〗^*。
   （2）客户端在得到候选扩展〖Φ_i〗^*后，客户端利用M_(GRR_X )扰动机制产生y。客户端有概率p不扰动本地数据，即p=Pr[y=v]=e^ε \/(e^ε+d-1)，其中候选域的大小d=|〖Φ_i〗^*  |；并有概率q扰动扰动数据，即p=Pr[y≠v]=(1-p)\/(d-1)=1\/(e^ε+d-1)。其中，ε为本地差分隐私预算，代表隐私保护的强度，ε越小，数据扰动程度越高，从而提供更强的数据隐私保护。
   （3）M_(GRR_X )扰动机制满足ε-LDP，即对于任意的输入v_1，v_2和输出y∈Φ^⋆，Pr[M_(GRR_X ) (v_1 )∈y]≤e^ε Pr[M_(GRR_X ) (v_2 )∈y]。
 循环上述步骤直至达到树的最大深度(i=g)，完成前缀树的构建。
 服务端从深度为g的前缀树中得到前k个频繁位串，对位串解码得到对应的频繁数据，如用ASCII编码与解码。利用位串表示方式能够允许联邦分析算法分析不同的数据形式，因为所有数据都可以用二进制的形式表示，只需要知道对应的编码与解码方式，从而提高了算法的灵活性。

## 4、本发明创新的关键点和想保护的技术方案是什么？
<!-- 撰写指导：
与已知的现有技术相比，本发明会有一些与其不同的关键区别点，这些关键区别点通常会带来明显的或重要的技术效果，这里请说明哪些点是关键区别点，并将这些点可能的组合方案都列举出来。
 -->

第一，本发明提出的联邦分析频繁数据挖掘算法采用了增量客户端分组策略，与传统的等量客户端分组策略相比，降低了用户总体的等待时间，从而提高了联邦分析系统的效率。
第二，在客户端扰动本地数据中，客户端只需要从限制域和本地真实数据中做出随机概率选择（计算复杂度为O(1)），而不是进行复杂的加密计算等，特别时在客户端计算资源不均的场景下，本发明极大程度上降低了客户端计算复杂度，从而提高了联邦分析的算法效率。
第三，该联邦分析频繁数据挖掘算法针对半可信执行环境提出了一种本地差分隐私扰动算法，与传统的算法相比，该算法利用放松受限域的方式，让后参与者并非完全信赖来自前参与者的受限域。在保证数据隐私的前提下，该算法通过允许后参与者向服务端发送受限域之外的数据从而增加了鲁棒性和预测准确性。

## 5、本发明可能的变更设计方向或者变形方案？
<!-- 撰写指导：
从整体考虑，是否有整体的替代或变形方案，或者对核心技术特征的替代或变形方案；主要根据本发明体现出来的设计思路，别人能不能想到其他的整体的替代方案来实现；
从另一个角度讲：考虑授权后，站在竞争对手的角度可能提出的回避设计方案。
 -->

（1）对于不同参与者设置权重，如前/后参与者有更高权重。
（2）换用不同的构建前缀树策略，如让一部分参与者先选择出候选数据，另一部分参与者参与前缀树的构建。
（3）对于选择候选频繁数据使用不同的策略，如设置阈值，当频繁前缀的频数大于设定阈值时选择该前缀为候选前缀。

## 6、发明人补充的其他观点和思路
<!-- 撰写指导：
除1－5部分还需要补充的部分。
 -->

## 7、图及说明
<!-- 撰写指导：
1、交底书部分中未提及的附图标记不得在附图中出现，附图中未出现的附图标记不得在交底书文字中提及；
2、附图中除必须词语（如电路或程序的方框图、流程图、波形图等）外，尽量不要包含有其它文字注释；
3、同一部件或部分的附图标记在前后几幅附图中应一致，同一附图标记不得表示不同的部件或部分；
4、附图集中放在交底书文字之后；
5、附图中，零部件的编号可以用数字表示，也可以直接用零部件的名称来表示。

 -->
图一是本发明的联邦频繁数据分析算法的流程图。
图二是本发明中算法服务端的流程图。
图三是本发明中算法客户端的流程图。
图四是本发明中前缀树构建过程的示意图。
